<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="generator" content="Adobe RoboHelp 2020" />
  <title>Определение входных данных</title>
  <meta name="topic-status" content="Draft" />
  <link rel="stylesheet" type="text/css" href="../../../assets/css/default.css" />
  <script src="../../../assets/scripts/main_script.js"></script>
  <meta name="template" content="../../../assets/masterpages/Manual_Page.htt" />
  <meta name="rh-authors" content="Gurpreet S. Matharoo" />
  <meta name="condition-tags" content="Export:Beta" />
</head>
<body>
  <h1>Определение входных данных</h1>
  <p>Вводами управляет система Rollback, поэтому они могут быть синхронизированы между игроками. Входные данные для игрока можно получить с помощью <span class="inline"><a href="Rollback_Functions/rollback_get_input.htm">rollback_get_input()</a></span>, который возвращает структуру, содержащую входные данные для игрока.</p>
  <h2>Входы по умолчанию</h2>
  <p>По умолчанию вы получите следующие ключи в структуре ввода:</p>
  <p class="code"><strong>left</strong>, <strong>right</strong>, <strong>up</strong>, <strong>down</strong>, <strong>Z</strong>, <strong>X</strong>, <strong>C</strong>, <strong>space</strong></p>
  <p>Направляющие входы отображаются на клавиши со стрелками.</p>
  <h2>Варианты ввода</h2>
  <p>Каждый определенный ввод с клавиатуры считывается с помощью <span class="inline"><a href="../Game_Input/Keyboard_Input/keyboard_check.htm">keyboard_check()</a></span>, который получает информацию о том, удерживается ли клавиша или нет. Для ввода мыши используется <span class="inline"><a href="../Game_Input/Mouse_Input/mouse_check_button.htm">mouse_check_button()</a></span>.</p>
  <p>С каждым определенным вводом (по умолчанию или пользовательским) вы также получаете варианты, использующие <span class="inline"><a href="../Game_Input/Keyboard_Input/keyboard_check_pressed.htm">keyboard_check_pressed()</a></span> и <span class="inline"><a href="../Game_Input/Keyboard_Input/keyboard_check_released.htm">keyboard_check_released()</a></span> (и эквивалентные функции для ввода с помощью мыши). Они добавляются с суффиксом &quot;<strong>_pressed</strong>&quot; и &quot;<strong>_released</strong>&quot; соответственно.</p>
  <p>Например, для ввода <span class="inline">space</span> вы получите также <span class="inline">space_pressed</span> и <span class="inline">space_released</span>.</p>
  <h2 id="h">Пользовательские регуляторы</h2>
  <h3>Определение</h3>
  <p>Чтобы определить свои собственные входы, создайте структуру, содержащую ключи ввода и назначенные константы для использования, а затем передайте ее в <span class="inline"><a href="Rollback_Functions/rollback_define_player.htm">rollback_define_input()</a></span>. Это отменит элементы управления по умолчанию, упомянутые в верхней части этой страницы.</p>
  <p>Вы определяете имена входов в левой части (например, <span class="inline2">fire</span>) и назначаете вход в правой части (например, <span class="inline2">mb_left</span>):</p>
  <p class="code">// Before starting rollback game<br />
    rollback_define_input({<br />
        fire: mb_left,<br />
        interact: vk_space,<br />
        left: ord(&quot;A&quot;),<br />
        right: ord(&quot;D&quot;)<br />
    });</p>
  <p>Вызов <span class="inline"><a href="Rollback_Functions/rollback_get_input.htm">rollback_get_input()</a></span> теперь будет возвращать только определенные здесь входы<span class="inline2">(fire</span>, <span class="inline2">interact</span> и т.д.), а также варианты <span class="inline2">*_pressed</span> и <span class="inline2">*_released</span> для каждого из них.</p>
  <p>Для <span class="notranslate">GML</span> Visual используйте <a data-xref="{title}" href="../../../Drag_And_Drop/Drag_And_Drop_Reference/Rollback/Define_Input.htm">Define Input (Rollback)</a>.</p>
  <h3>Константы</h3>
  <p>Вы можете назначить любое из следующих входных значений входам в вашей структуре:</p>
  <table>
    <colgroup>
      <col />
      <col />
      <col />
    </colgroup>
    <tbody>
      <tr>
        <th>Тип входа</th>
        <th>Значение</th>
        <th>Описание</th>
      </tr>
      <tr>
        <td colspan="1" rowspan="2"><strong>Клавиатура</strong></td>
        <td><span class="inline">vk_*</span> константы</td>
        <td>Используйте эти константы для определения клавиш клавиатуры. Список таких констант приведен <a href="../Game_Input/Keyboard_Input/Keyboard_Input.htm">здесь</a>.</td>
      </tr>
      <tr>
        <td><span class="inline">ord(&quot;&quot;)</span></td>
        <td>Определите буквенный ключ, обернув его в <a href="../Strings/ord.htm"><span class="inline">ord()</span></a>.</td>
      </tr>
      <tr>
        <td><strong>Геймпад</strong></td>
        <td><span class="inline">gp_*</span> константы</td>
        <td>Используйте эти константы для определения входов геймпада (кнопки и оси). Список таких констант приведен <a href="../Game_Input/GamePad_Input/Gamepad_Input.htm">здесь</a>.</td>
      </tr>
      <tr>
        <td colspan="1" rowspan="7"><strong>Мышь</strong></td>
        <td><span class="inline">mb_*</span> константы</td>
        <td>Используйте эти константы для определения кнопок мыши. Список таких констант приведен <a href="../Game_Input/Mouse_Input/Mouse_Input.htm">здесь</a>.<br>
          <br>
         <span class="note">ПРИМЕЧАНИЕ</span>: <span class="inline">mb_any</span> и <span class="inline">mb_none</span> не могут быть использованы.
        </td>
      </tr>
      <tr>
        <td><span class="inline">m_axisx</span></td>
        <td>X-позиция мыши в комнате (с помощью <span class="inline"><a href="../Game_Input/Mouse_Input/mouse_x.htm">mouse_x</a></span>).</td>
      </tr>
      <tr>
        <td><span class="inline">m_axisy</span></td>
        <td>Положение мыши по оси Y в комнате (с помощью <span class="inline"><a href="../Game_Input/Device_Input/device_mouse_y.htm">mouse_y</a></span>).</td>
      </tr>
      <tr>
        <td><span class="inline">m_axisx_gui</span></td>
        <td>Положение X мыши на слое графического интерфейса пользователя (с помощью <a href="../Game_Input/Device_Input/device_mouse_x_to_gui.htm"><span class="inline">device_mouse_x_to_gui()</span></a>).</td>
      </tr>
      <tr>
        <td><span class="inline">m_axisy_gui</span></td>
        <td>Положение мыши по оси Y на слое GUI (с помощью <a href="../Game_Input/Device_Input/device_mouse_y_to_gui.htm"><span class="inline">device_mouse_y_to_gui()</span></a>).</td>
      </tr>
      <tr>
        <td><span class="inline">m_scroll_up</span></td>
        <td><span class="inline">1</span> если колесо мыши прокручивается вверх, <span class="inline">0</span> в противном случае.</td>
      </tr>
      <tr>
        <td><span class="inline">m_scroll_down</span></td>
        <td><span class="inline">1</span> если колесо мыши прокручивается вниз, <span class="inline">0</span> в противном случае.</td>
      </tr>
    </tbody>
  </table>
  <h3>Множественные элементы управления</h3>
  <p>Вы можете назначить несколько элементов управления для каждого входа, перечислив константы входа в массиве:</p>
  <p class="code">rollback_define_input({<br />
        fire:     [mb_left, ord(&quot;X&quot;)],<br />
        interact: [vk_space, ord(&quot;C&quot;)],<br />
        left:     [ord(&quot;A&quot;), vk_left],<br />
        right:    [ord(&quot;D&quot;), vk_right]<br />
    });</p>
  <p>В этом примере <span class="inline2">огонь</span> будет вызван нажатием <span class="inline2">mb_left</span> и клавиши <span class="inline2">X</span>, <span class="inline2">взаимодействие</span> - нажатием <span class="inline2">vk_space</span> и клавиши <span class="inline2">C</span>, и так далее.</p>
  <p class="code">var _input = rollback_get_input();<br />
    if (_input.fire)<br />
    {<br />
        // Runs when LMB or X is pressed<br />
    }</p>
  <p class="note"><span class="note">ПРИМЕЧАНИЕ</span> Вы не можете связать одну и ту же входную константу с несколькими входами, например, конкретное входное значение (скажем, <span class="inline2">mb_left</span> или <span class="inline2">ord(&quot;A&quot;)</span>) может быть использовано только <strong>один раз</strong> во всей вашей структуре ввода.</p>
  <h2 id="h1">Инсценировка ввода</h2>
  <p>При локальном тестировании вы можете определить временные входы для удаленных игроков, чтобы можно было тестировать многопользовательскую игру в автономном режиме.</p>
  <p>Вы можете достичь этого, определив подражательный ввод для игрока, используя <a href="Rollback_Functions/rollback_define_mock_input.htm"><span class="inline">rollback_define_mock_input()</span></a>. Например, после вызова приведенного выше фрагмента кода для определения входов <span class="inline">fire</span>, <span class="inline">interact</span>, <span class="inline">left</span> и <span class="inline">right</span> для всех игроков, вы можете определить отдельный набор входов специально для второго игрока, который вы можете использовать во время тестирования синхронизации.</p>
  <p class="code">rollback_define_mock_input(1, {<br />
        fire: vk_control,<br />
        interact: vk_shift,<br />
        left: ord(&quot;J&quot;),<br />
        right: ord(&quot;L&quot;)<br />
    });</p>
  <p>Это определяет макет входа для игрока 1 (второго игрока), сохраняя те же имена входов, но назначая разные входы. Таким образом, два человека могут играть в игру локально на одном компьютере.</p>
  <h2>Дальнейшее чтение</h2>
  <p>Более подробную информацию о системе Rollback читайте на следующих страницах:</p>
  <ul class="colour">
    <li><a data-xref="{title}" href="Rollback_Constraints.htm">Ограничения отката</a></li>
    <li><a data-xref="{title}" href="Rollback_Events.htm">События отката</a></li>
    <li><a href="Creating_Multiplayer.htm">Создание многопользовательской игры</a></li>
    <li><a data-xref="{title}" href="Rollback_System.htm">Система отката</a></li>
  </ul>
  <p> </p>
  <p> </p>
  <div class="footer">
    <div class="buttons">
      <div class="clear">
        <div>Назад: <a data-xref="{title}" href="Rollback_Multiplayer.htm">Rollback Multiplayer</a></div>
        <div>Следующий: <a data-xref="{title}" href="Rollback_Constraints.htm">Ограничения отката</a></div>
      </div>
    </div>
    <h5><span data-keyref="Copyright Notice">© Copyright <span class="notranslate">YoYo Games Ltd.</span> 2022 Все права защищены</span></h5>
  </div>
</body>
</html>