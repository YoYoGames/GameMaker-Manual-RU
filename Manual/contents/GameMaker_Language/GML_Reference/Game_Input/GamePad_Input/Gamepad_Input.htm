<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Вход геймпада</title>
  <meta name="generator" content="Adobe RoboHelp 2020" />
  <link rel="stylesheet" href="../../../../assets/css/default.css" type="text/css" />
  <script src="../../../../assets/scripts/main_script.js"></script>
  <meta name="rh-authors" content="Mark Alexander" />
  <meta name="topic-comment" content="Reference section for Gamepad Input" />
  <meta name="rh-index-keywords" content="gp_face1,gp_face2,gp_face3,gp_face4,gp_shoulderl,gp_shoulderlb,gp_shoulderr,gp_shoulderrb,gp_select,gp_start,gp_stickl,gp_stickr,gp_padu,gp_padd,gp_padl,gp_padr,gp_axislh,gp_axislv,gp_axisrh,gp_axisrv,gp_axis_acceleration_x,gp_axis_acceleration_y,gp_axis_acceleration_z,gp_axis_angular_velocity_x,gp_axis_angular_velocity_y,gp_axis_angular_velocity_z,gp_axis_orientation_x,gp_axis_orientation_y,gp_axis_orientation_z,gp_axis_orientation_w" />
  <meta name="search-keywords" content="Gamepad Input,gamepads,gp_face1,gp_face2,gp_face3,gp_face4,gp_shoulderl,gp_shoulderlb,gp_shoulderr,gp_shoulderrb,gp_select,gp_start,gp_stickl,gp_stickr,gp_padu,gp_padd,gp_padl,gp_padr,gp_axislh,gp_axislv,gp_axisrh,gp_axisrv,gp_axis_acceleration_x,gp_axis_acceleration_y,gp_axis_acceleration_z,gp_axis_angular_velocity_x,gp_axis_angular_velocity_y,gp_axis_angular_velocity_z,gp_axis_orientation_x,gp_axis_orientation_y,gp_axis_orientation_z,gp_axis_orientation_w" />
</head>
<body>
  <!--<div class="body-scroll" style="top: 150px;">-->
  <h1>Вход геймпада</h1>
  <p><b></b>В<span data-keyref="GameMaker Name">GameMaker</span> есть ряд специальных функций, которые можно использовать для обнаружения аналоговых и цифровых элементов управления от нескольких подключенных геймпадов. Эти функции работают аналогично <a href="../Device_Input/Device_Input.htm">входам устройства</a>, поскольку вы можете обнаружить до четырех различных подключенных геймпадов XInput (и до 8 геймпадов DirectInput) и обрабатывать входные данные от каждого из них с помощью одних и тех же функций. Обратите внимание, что когда геймпад подключается к вашему устройству (или отсоединяется), запускается асинхронное <a href="../../../../The_Asset_Editors/Object_Properties/Async_Events.htm">системное событие</a>, в котором вы можете разобраться с ситуацией с помощью соответствующих функций.</p>
  <p>Слоты для геймпадов индексируются от 0 вверх, и фактический слот, назначенный геймпаду, зависит от множества факторов, не последним из которых является ОС, на которой работает проект. В проекте для <strong>Windows</strong> слоты 0 - 3 включительно предназначены <i>только для геймпадов Xinput</i>, то есть контроллеров Xbox360 и совместимых с ними. Однако вы также можете проверить слоты 4 - 11 включительно для геймпадов <i>DirectInput</i>, что означает, что вы можете обнаружить множество других моделей контроллеров при подключении через эти слоты. На других платформах планшеты могут быть обнаружены в <em>любом</em> слоте, назначенном ОС, который может быть слотом 3, слотом 20 или более. Например, устройства <strong>Android</strong> сохраняют bluetooth-геймпады в слоте и затем резервируют этот слот для этого геймпада в будущем, независимо от того, подключен он или нет, поэтому <em>нельзя</em> считать, что один подключенный геймпад подключен к слоту 0, так как это, скорее всего, не так.</p>
  <p>Стоит отметить, что при использовании геймпадов DirectInput на <span class="notranslate">Windows</span>, или общих геймпадов на других платформах, приведенные ниже константы <strong>могут не совпадать с кнопками, которые вы ожидаете при нажатии</strong>, из-за фрагментарного и нестандартизированного способа реализации API производителями контроллеров. В связи с этим рекомендуется иметь в играх экран настройки геймпада, где люди могут переопределять кнопки геймпада на основе ввода от любого подключенного устройства, чтобы уменьшить любые проблемы (существуют функции &quot;отображения&quot; геймпада, которые могут помочь в этом для целей <span class="notranslate">Windows</span> Desktop, <span class="notranslate">Ubuntu</span>, <span class="notranslate">macOS</span> и <span class="notranslate">Android</span>, в то время как для всех остальных вам придется сделать это самостоятельно с помощью кода).</p>
  <h2>Входные константы</h2>
  <p>При работе с функциями геймпада ввод может осуществляться через <strong>оси</strong>, <strong>кнопки</strong> или <strong>шляпы</strong>, которые <span data-keyref="GameMaker Name">GameMaker</span> присваивает следующим встроенным константам (обратите внимание, что &quot;шляпы&quot; обычно обнаруживаются только на нестандартных контроллерах):</p>
  <table>
    <tbody>
      <tr>
        <th colspan="2"><span data-keyref="Type_Constant_Gamepad_Button"><a data-rhwidget="HyperlinkPopover" href="../../../../../GameMaker_Language/GML_Reference/Game_Input/GamePad_Input/gamepad_axis_value.htm">Постоянная кнопка геймпада</a></span></th>
      </tr>
      <tr>
        <th>Постоянная</th>
        <th>Описание</th>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_face1</span></td>
        <td>Верхняя кнопка 1 (соответствует кнопке <i>&quot;A&quot;</i> на контроллере Xbox 360 и <i>кресту</i> на контроллере PS)</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_face2</span></td>
        <td>Верхняя кнопка 2 (соответствует кнопке <i>&quot;B&quot;</i> на контроллере Xbox 360 и <i>кругу</i> на контроллере PS)</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_face3</span></td>
        <td>Верхняя кнопка 3 (соответствует <i>&quot;X&quot;</i> на контроллере Xbox 360 и <i>квадрату</i> на контроллере PS)</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_face4</span></td>
        <td>Верхняя кнопка 4 (соответствует букве <i>&quot;Y&quot;</i> на контроллере Xbox 360 и <i>треугольнику</i> на контроллере PS)</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_shoulderl</span></td>
        <td>Пуговица на левом плече</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_shoulderlb</span></td>
        <td>Спусковой крючок левого плеча</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_shoulderr</span></td>
        <td>Правая плечевая кнопка</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_shoulderrb</span></td>
        <td>Спусковой крючок правого плеча</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_select</span></td>
        <td>Кнопка выбора (на контроллере DS4 она срабатывает при нажатии сенсорной панели вниз)</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_start</span></td>
        <td>Кнопка запуска (это кнопка &quot;опции&quot; на контроллере PS4)</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_stickl</span></td>
        <td>Левый стик нажат (как кнопка)</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_stickr</span></td>
        <td>Правый стик нажат (как кнопка)</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_padu</span></td>
        <td>D-пад вверх</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_padd</span></td>
        <td>D-пад вниз</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_padl</span></td>
        <td>D-pad влево</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_padr</span></td>
        <td>D-pad вправо</td>
      </tr>
    </tbody>
  </table>
  <table>
    <colgroup>
      <col />
      <col />
    </colgroup>
    <tbody>
      <tr>
        <th colspan="2"><span data-keyref="Type_Constant_Gamepad_Axis"><a data-rhwidget="HyperlinkPopover" href="../../../../../GameMaker_Language/GML_Reference/Game_Input/GamePad_Input/gamepad_axis_value.htm">Постоянная оси геймпада</a></span></th>
      </tr>
      <tr>
        <th>Постоянная</th>
        <th>Описание</th>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_axislh</span></td>
        <td>Горизонтальная ось левого стика (аналоговая)</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_axislv</span></td>
        <td>Вертикальная ось левого стика (аналоговая)</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_axisrh</span></td>
        <td>Горизонтальная ось правого стика (аналоговая)</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_axisrv</span></td>
        <td>Вертикальная ось правого стика (аналоговая)</td>
      </tr>
      <tr>
        <th colspan="2">Приведенные ниже константы можно использовать только с геймпадом DualSense на PS4 или PS5.</th>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_axis_acceleration_x</span>*</td>
        <td>Ускорение геймпада по оси X</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_axis_acceleration_y</span>*</td>
        <td>Ускорение геймпада по оси Y</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_axis_acceleration_z</span>*</td>
        <td>Ускорение геймпада по оси Z</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_axis_angular_velocity_x</span>*</td>
        <td>Угловая скорость геймпада по оси X</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_axis_angular_velocity_y</span>*</td>
        <td>Угловая скорость геймпада по оси Y</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_axis_angular_velocity_z</span>*</td>
        <td>Угловая скорость геймпада по оси Z</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_axis_orientation_x</span>*</td>
        <td>Ориентация геймпада по оси X</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_axis_orientation_y</span>*</td>
        <td>Ориентация геймпада по оси Y</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_axis_orientation_z</span>*</td>
        <td>Ориентация геймпада по оси Z</td>
      </tr>
      <tr>
        <td><span class="notranslate"><span class="inline">gp_axis_orientation_w</span>*</td>
        <td>Ориентация геймпада по оси W</td>
      </tr>
    </tbody>
  </table>
  <p class="note"><span class="note">ПРИМЕЧАНИЕ</span> <strong>Ориентация</strong> геймпада - это <a href="https://en.wikipedia.org/wiki/Quaternion" title="Quaternion">кватернион</a>, поэтому он имеет четыре значения (X, Y, Z и W).<br>
    <br>
    * Эти константы поддерживаются только на PS4 и PS5, при использовании на других платформах функции ввода вернут <span class="inline">0</span>, даже при использовании геймпада DualSense.
  </p>
  <p>Чтобы лучше понять, какую именно часть контроллера представляет каждая константа, вы можете обратиться к следующему изображению стандартного геймпада XInput:</p>
  <p><img alt="Xinput gamepad illustration" class="center" src="../../../../assets/Images/Scripting_Reference/GML/Reference/Game_Input/GamePad.png" /></p>
  <h2>Функции</h2>
  <p>Ниже приведен список всех функций геймпада:</p>
  <ul class="colour">
    <li><a href="gamepad_is_supported.htm"><span class="notranslate">gamepad_is_supported</span></a></li>
    <li><a href="gamepad_is_connected.htm"><span class="notranslate">gamepad_is_connected</span></a></li>
    <li><a href="gamepad_get_guid.htm"><span class="notranslate">gamepad_get_guid</span></a></li>
    <li><a href="gamepad_get_device_count.htm"><span class="notranslate">gamepad_get_device_count</span></a></li>
    <li><a href="gamepad_get_description.htm"><span class="notranslate">gamepad_get_description</span></a></li>
    <li><a href="gamepad_get_button_threshold.htm"><span class="notranslate">gamepad_get_button_threshold</span></a></li>
    <li><a href="gamepad_get_axis_deadzone.htm"><span class="notranslate">gamepad_get_axis_deadzone</span></a></li>
    <li><a href="gamepad_get_option.htm"><span class="notranslate">gamepad_get_option</span></a></li>
    <li><a href="gamepad_set_button_threshold.htm"><span class="notranslate">gamepad_set_button_threshold</span></a></li>
    <li><a href="gamepad_set_axis_deadzone.htm"><span class="notranslate">gamepad_set_axis_deadzone</span></a></li>
    <li><a href="gamepad_set_vibration.htm"><span class="notranslate">gamepad_set_vibration</span></a></li>
    <li><a href="gamepad_set_colour.htm"><span class="notranslate">gamepad_set_colour</span></a></li>
    <li><a href="gamepad_set_option.htm"><span class="notranslate">gamepad_set_option</span></a></li>
    <li><a href="gamepad_axis_count.htm"><span class="notranslate">gamepad_axis_count</span></a></li>
    <li><a href="gamepad_axis_value.htm"><span class="notranslate">gamepad_axis_value</span></a></li>
    <li><a href="gamepad_button_check.htm"><span class="notranslate">gamepad_button_check</span></a></li>
    <li><a href="gamepad_button_check_pressed.htm"><span class="notranslate">gamepad_button_check_pressed</span></a></li>
    <li><a href="gamepad_button_check_released.htm"><span class="notranslate">gamepad_button_check_released</span></a></li>
    <li><a href="gamepad_button_count.htm"><span class="notranslate">gamepad_button_count</span></a></li>
    <li><a href="gamepad_button_value.htm"><span class="notranslate">gamepad_button_value</span></a></li>
    <li><a href="gamepad_hat_count.htm"><span class="notranslate">gamepad_hat_count</span></a></li>
    <li><a href="gamepad_hat_value.htm"><span class="notranslate">gamepad_hat_value</span></a></li>
  </ul>
  <p> </p>
  <p>Существуют также следующие функции геймпада, которые используются для переназначения встроенных констант на прямые физические входы данного геймпада. Эти функции предназначены только для целевых платформ <span class="notranslate">Windows</span> Desktop, <span class="notranslate">Ubuntu</span>, <span class="notranslate">macOS</span> и <span class="notranslate">Android</span>, а на <span class="notranslate">Windows</span> они будут действительны только для устройств прямого ввода. Хотя <span data-keyref="GameMaker Name">GameMaker</span> поставляется с отображениями для ряда различных геймпадов на основе <a href="https://github.com/gabomdq/SDL_GameControllerDB" target="_blank">SDL Gamepad Controller DB</a>, однако из-за огромного количества типов и марок контроллеров невозможно сопоставить константы <span class="notranslate">GML</span> с правильными входами для каждой марки и модели, поэтому с помощью этих функций у вас есть возможность создать свои собственные отображения.</p>
  <ul class="colour">
    <li><a href="gamepad_get_mapping.htm"><span class="notranslate">gamepad_get_mapping</span></a></li>
    <li><a href="gamepad_test_mapping.htm"><span class="notranslate">gamepad_test_mapping</span></a></li>
    <li><a href="gamepad_remove_mapping.htm"><span class="notranslate">gamepad_remove_mapping</span></a></li>
  </ul>
  <p> </p>
  <p>Стоит отметить, что геймпады с прямым вводом работают в <i>кооперативном режиме</i>, что означает, что ваша игра имеет к ним доступ только тогда, когда она является приложением переднего плана, что, в свою очередь, приведет к тому, что контроллеры прямого ввода будут &quot;потеряны&quot;, если игра потеряет фокус, а затем &quot;найдены&quot; снова, когда она вернется в фокус (это может быть обнаружено в системном событии и устранено). Аналогично, никакой ввод от геймпадов не будет обнаружен, пока игра не в фокусе, и мы рекомендуем вам использовать функцию <a href="../../OS_And_Compiler/os_is_paused.htm"><span class="inline">os_is_paused()</span></a> или <a href="../../Cameras_And_Display/The_Game_Window/window_has_focus.htm"><span class="inline">window_has_focus()</span></a> чтобы обнаружить это и поставить игру на паузу или что-то подобное, поскольку любая кнопка, удерживаемая в момент, когда игра теряет фокус, будет удерживаться до тех пор, пока игра не восстановит фокус.</p>
  <h2>Совместимость</h2>
  <p>В приведенном ниже списке указана текущая совместимость платформ (обратите внимание, что она будет меняться с будущими обновлениями):</p>
  <ul class="colour">
    <li><strong>Windows </strong>полностью поддерживается, при этом одновременно можно подключить до 12 устройств (нумерация от 0 до 11, где 0 - 3 - устройства XInput, а 4 - 11 - DirectInput). Также разрешено переназначение констант контроллера.</li>
    <li>В<strong>macOS </strong>поддерживается не более 4 подключенных устройств одновременно, и эти устройства могут быть ТОЛЬКО типа Playstation3 или Xbox 360. Обратите внимание, что опция &quot;Build for Mac AppStore&quot; в Mac Game Options должна быть выключена, чтобы поддержка пэдов работала. Также разрешено переназначение констант контроллера.</li>
    <li><strong>Ubuntu </strong>также поддерживает ввод с геймпада, но вам может потребоваться установить дополнительные библиотеки из репозитория <span class="notranslate">Ubuntu</span>. Это можно легко сделать, открыв терминал командной строки и набрав следующее (это установит поддержку GUI для джойстика/геймпада, а также сам API джойстика/геймпада - изменение констант контроллера <i>не</i> допускается):
     <p class="code">sudo apt-get install jstest-gtk<br />
        sudo apt-get install joystick.</p>
    </li>
    <li><strong>HTML5-игры </strong>с использованием геймпадов поддерживаются большинством основных браузеров, кроме <i>Safari</i>. Переназначение констант контроллера <i>не</i> допускается.</li>
    <li>Веб-браузеры обнаруживают геймпады только при нажатии кнопки или перемещении оси, поэтому они могут быть недоступны в момент непосредственного начала игры. Это относится к целевым платформам <strong>Opera GX</strong> и <strong>HTML </strong>.</li>
    <li>Поддержка геймпада также распространяется на <strong>iOS </strong>с корпусом iCade. Левая ось соответствует стику контроллера (хотя вход цифровой, а не аналоговый), четыре &quot;лицевые&quot; кнопки соответствуют передним кнопкам корпуса, а четыре плечевые кнопки соответствуют кнопкам на задней панели корпуса.</li>
    <li>Экспорт<strong>Android </strong>(и <strong>Amazon Fire</strong>) поддерживает контроллеры NYKO и общие контроллеры Bluetooth, но только если они включены, то есть вам придется отметить опцию iCade/Bluetooth в разделе " <a href="../../../../Settings/Game_Options/Android.htm">Общие"</a> на странице <span class="notranslate">Android</span> "Параметры игры". Для их полноценной работы требуется уровень API 12, и следует отметить, что <span data-keyref="GameMaker Name">GameMaker</span> будет регистрировать как подключенные любые Bluetooth-устройства, с которыми сопряжено ваше устройство, независимо от того, подключено оно на самом деле или нет. Поэтому это следует учитывать при назначении и проверке &quot;слотов&quot;. Обратите внимание, что переназначение констант контроллера также разрешено.</li>
    <li>На <strong>PS4</strong>, если вы хотите использовать сенсорную панель для отслеживания, вам нужно использовать <a href="../Device_Input/Device_Input.htm"><span class="inline">device_mouse_*</span></a> кнопки. Переназначение констант контроллера <i>не</i> допускается.</li>
    <li>В целях <strong>Windows </strong><strong>UWP</strong>, <strong>XBoxOne </strong>и <strong>Nintendo Switch</strong> геймпады полностью поддерживаются, но ремаппинг констант контроллера <i>не</i> допускается.</li>
  </ul>
  <p>В идеале, на <i>всех</i> целевых платформах вы хотите перечислить список доступных &quot;слотов&quot; для геймпадов, а затем проверить, обнаружены ли какие-либо устройства, примерно так:</p>
  <p class="code">var _maxpads = gamepad_get_device_count();<br />
    <br />
    for (var i = 0; i &lt; _maxpads; i++)<br />
    {<br />
        if (gamepad_is_connected(i))<br />
        {<br />
            // do stuff with pad &quot;i&quot;<br />
        }<br />
    }
  </p>
  <p> </p>
  <p> </p>
  <div class="footer">
    <div class="buttons">
      <div class="clear">
        <div style="float:left">Назад: <a href="../Game_Input.htm">Игровой вход</a></div>
        <div style="float:right">Следующее: <a href="../Virtual_Keys_And_Keyboards/Virtual_Keys_And_Keyboards.htm">Виртуальные клавиши и виртуальные клавиатуры</a></div>
      </div>
    </div>
    <h5><span data-keyref="Copyright Notice">© Copyright <span class="notranslate">YoYo Games Ltd.</span> 2022 Все права защищены</span></h5>
  </div>
  <!-- KEYWORDS
Gamepad Input Functions
gp_face1
gp_face2
gp_face3
gp_face4
gp_shoulderl
gp_shoulderlb
gp_shoulderr
gp_shoulderrb
gp_select
gp_start
gp_stickl
gp_stickr
gp_padu
gp_padd
gp_padl
gp_padr
gp_axislh
gp_axislv
gp_axisrh
gp_axisrv
gp_axis_acceleration_x
gp_axis_acceleration_y
gp_axis_acceleration_z
gp_axis_angular_velocity_x
gp_axis_angular_velocity_y
gp_axis_angular_velocity_z
gp_axis_orientation_x
gp_axis_orientation_y
gp_axis_orientation_z
gp_axis_orientation_w
-->
  <!-- TAGS
gamepad_functions
-->
</body>
</html>